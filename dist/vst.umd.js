(function(e,p){typeof exports=="object"&&typeof module<"u"?module.exports=p(require("vue")):typeof define=="function"&&define.amd?define(["vue"],p):(e=typeof globalThis<"u"?globalThis:e||self,e.VueSlimTable=p(e.Vue))})(this,function(e){"use strict";const p="",B=["colspan"],$=[e.createElementVNode("div",null,null,-1)],V=e.defineComponent({__name:"loading_row",props:{columnsLength:{type:Number,required:!0}},setup(n){const i=Math.floor(Math.random()*10)+1;return(l,s)=>(e.openBlock(),e.createElementBlock("tr",null,[e.createElementVNode("td",{colspan:n.columnsLength,class:e.normalizeClass(["vst-loading-row",`vst-loading-row-${i}`])},$,10,B)]))}}),m={INITIAL:"initial",SYNCING:"syncing",SYNCED:"synced",FAILED:"failed"},C=({initialFilters:n,loadItems:i})=>{const l=e.ref(1),s=e.reactive({value:[]}),o=e.ref(m.INITIAL),g=e.reactive({value:n}),a=e.computed(()=>({page:l.value,...g.value})),c=()=>(o.value=m.SYNCING,i(a.value).then(h=>{s.value=h,o.value=m.SYNCED}).catch(()=>{s.value=[],o.value=m.FAILED}));return c(),e.watch(a,c),{page:l,items:s,syncState:o,nextPage:()=>{l.value+=1},prevPage:()=>{l.value-=1},isSyncing:e.computed(()=>o.value===m.SYNCING),isSynced:e.computed(()=>o.value===m.SYNCED),isFailed:e.computed(()=>o.value===m.FAILED),reload:()=>{c()},refetch:()=>{l.value===1?c():l.value=1}}},y=(n,i)=>(l,[s,o])=>{if(o==null)return l;const g=encodeURIComponent(s),a=i?`${i}[${g}]`:g;return["number","string"].includes(typeof o)?(l.push(`${a}=${encodeURIComponent(o)}`),l):(l.push(Object.entries(o).reduce(y(o,a),[]).join("&")),l)},b=n=>Object.entries(n).reduce(y(),[]).join("&"),u={class:"vst"},I={key:0},w={key:0},F=["colspan"],L=["colspan"],T={key:0,class:"vst-pagination mt-3"};return e.defineComponent({__name:"slim_table",props:{columns:null,source:null,perPage:{default:25}},setup(n,{expose:i}){const l=n,s=e.shallowRef({}),o=async r=>{let d;return typeof l.source=="string"?d=await(await fetch(`${l.source}?${b(r)}`)).json():d=await l.source(r),d},g=r=>{s.value[r]==="asc"?s.value={[r]:"desc"}:s.value[r]==="desc"?s.value={}:s.value={[r]:"asc"}},{page:a,isSyncing:c,isSynced:h,prevPage:E,nextPage:S,reload:D,refetch:P,items:f}=C({initialFilters:{per_page:l.perPage,orders:s.value},loadItems:o});return i({refetch:P,reload:D,rows:f}),(r,d)=>(e.openBlock(),e.createElementBlock("table",u,[n.columns.length?(e.openBlock(),e.createElementBlock("thead",I,[e.renderSlot(r.$slots,"thead",{columns:n.columns,orders:e.unref(s)},()=>[e.createElementVNode("tr",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.columns,t=>(e.openBlock(),e.createElementBlock("th",e.mergeProps({key:t.key,class:["vst-th",{"vst-orderable":t.orderable}]},e.toHandlers(t.orderable?{click:()=>g(t.key)}:{},!0)),[t.orderable?(e.openBlock(),e.createElementBlock("div",w,[e.renderSlot(r.$slots,`head:${t.key}`,{column:t},()=>[e.createTextVNode(e.toDisplayString(t.title),1)]),e.createElementVNode("a",{href:"#",class:e.normalizeClass(["vst-orderable-toggle",e.unref(s)[t.key]])},null,2)])):e.renderSlot(r.$slots,`thead:${t.key}`,{key:1,column:t},()=>[e.createTextVNode(e.toDisplayString(t.title),1)])],16))),128))])])])):e.createCommentVNode("",!0),e.createElementVNode("tbody",null,[e.unref(c)?e.renderSlot(r.$slots,"row:loading",{key:0},()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.perPage,t=>(e.openBlock(),e.createBlock(V,{key:`loadingRow${t}`,"columns-length":n.columns.length},null,8,["columns-length"]))),128))]):e.unref(h)&&e.unref(f).value.length===0?e.renderSlot(r.$slots,"row:empty",{key:1},()=>[e.createElementVNode("tr",null,[e.createElementVNode("td",{colspan:n.columns.length}," No records found ",8,F)])]):e.unref(h)&&e.unref(f).value.length?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:2},e.renderList(e.unref(f).value,(t,N)=>e.renderSlot(r.$slots,"row",{row:t,index:N,columns:n.columns},()=>[(e.openBlock(),e.createElementBlock("tr",{key:t.id||N},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.columns,k=>(e.openBlock(),e.createElementBlock("td",{key:k.key},[e.renderSlot(r.$slots,`cell:${k.key}`,{row:t,value:t[k.key],column:k,index:N},()=>[e.createTextVNode(e.toDisplayString(t[k.key]),1)])]))),128))]))])),256)):e.createCommentVNode("",!0)]),e.createElementVNode("tfoot",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",{colspan:n.columns.length},[e.renderSlot(r.$slots,"pagination",{page:e.unref(a),rows:e.unref(f).value},()=>[e.unref(a)>1||e.unref(f).value.length===n.perPage||e.unref(c)?(e.openBlock(),e.createElementBlock("ul",T,[e.createElementVNode("li",{class:e.normalizeClass(["vst-page-item",{disabled:e.unref(a)===1||e.unref(c)}])},[e.createElementVNode("a",{class:"vst-page-link",onClick:d[0]||(d[0]=e.withModifiers((...t)=>e.unref(E)&&e.unref(E)(...t),["prevent"]))},"←")],2),e.createElementVNode("li",{class:e.normalizeClass(["vst-page-item",{disabled:e.unref(f).value.length<n.perPage||e.unref(c)}])},[e.createElementVNode("a",{class:"vst-page-link",onClick:d[1]||(d[1]=e.withModifiers((...t)=>e.unref(S)&&e.unref(S)(...t),["prevent"]))},"→")],2)])):e.createCommentVNode("",!0)])],8,L)])])]))}})});
//# sourceMappingURL=vst.umd.js.map
